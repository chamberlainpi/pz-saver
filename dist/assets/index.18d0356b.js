var oe=Object.defineProperty,ne=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var j=(l,a,t)=>a in l?oe(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,q=(l,a)=>{for(var t in a||(a={}))le.call(a,t)&&j(l,t,a[t]);if(H)for(var t of H(a))re.call(a,t)&&j(l,t,a[t]);return l},K=(l,a)=>ne(l,ae(a));import{r as g,a as M,c as E,d as R,o as u,b as d,n as S,e as T,w as Z,v as W,u as n,f as e,i as ie,g as k,h as x,j as L,k as z,l as J,F,m as G,p as C,_ as N,q as X,t as V,s as ce,x as ue,y as de,z as pe,A as me}from"./vendor.ab550cb8.js";const he=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}};he();globalThis.trace=console.log.bind(console);const _e=(l,a)=>{const t=g(l);async function s(){const{data:o}=await M.get(a);t.value=o[0]}return s(),t},ve=(l,a,t="modelValue")=>E({get:()=>l[t],set:s=>a(`update:${t}`,s)}),I=(l,a)=>R.duration((a||R()).diff(R(l))).format("D[d] HH:mm:ss [ago]").replace("0d ","");const fe={props:{name:String},setup(l){return(a,t)=>(u(),d("i",{class:S("fa fa-"+l.name)},null,2))}},be={class:"hbox items-center text-xs p-2 select-none cursor-pointer"},ge={key:0},xe={key:1,class:"abs right-2"},ye={props:{color:String,modelValue:Boolean},setup(l,{emit:a}){const s=ve(l,a);return(o,c)=>{const i=T("icon");return u(),d("label",be,[Z(e("input",{type:"checkbox",class:"hidden","onUpdate:modelValue":c[0]||(c[0]=y=>ie(s)?s.value=y:null)},null,512),[[W,n(s)]]),e("div",{class:S(["hbox items-center px-2 pt-1 w-14 h-7 rel rounded-full m-0 text-white leading-5",[n(s)?"bg-green-500":"bg-red-900"]])},[n(s)?k("",!0):(u(),d("i",ge,"OFF")),x(i,{name:"circle",class:S(["abs right-1 top-0 text-lg transition-all opacity-80",[n(s)?"-translate-x-7":""]])},null,8,["class"]),n(s)?(u(),d("i",xe,"ON")):k("",!0)],2)])}}},P=_e({pzRoot:""},"/config");async function we(){const{data:l}=await M.post("/config",P.value);trace(l)}const ee=g({isBaselineSnapped:!1,isCurrentSnapped:!1});async function te(){let{data:l}=await M.get("/status");ee.value=l,setTimeout(te,3e3)}var Q;const b=g((Q=L.exports.cookies.isCompact)!=null?Q:!0);z(b,l=>L.exports.cookies.isCompact=l);const ke={class:"game-folders panel"},Se={class:"hbox items-center font-bold"},$e={class:"nowrap"},Ce=C("Folders"),Pe={key:0,class:"ml-auto"},Te=["disabled"],Ve=C(" Refresh "),Me={key:0,class:"hbox items-center w-full text-2xl px-2"},Ae=e("i",{class:"font-bold"},"Filters:",-1),Be=["title"],Ee=["value"],Re={class:"hbox all-center text-lg gap-2 px-2 py-1"},Ne=["onUpdate:modelValue"],Le={class:"flex-shrink hbox all-center"},Ue={key:0,class:"small-tag bg-green-600"},De=["title"],Ze={setup(l){const a="All, Build:Builder, Surv:Survivor, Sand:Sandbox, YH1D:You Have One Day".split(", ").map(r=>{let[p,v]=r.split(":");return v||(v=p),{alias:p,fullname:v}}),t=g(L.exports.cookies.filter||"All"),s=g([]),o=E(()=>s.value.filter(r=>r.isSelected)),c=E(()=>o.value.length===1?o.value[0]:null),i=r=>P.value.current===r.path,y=()=>s.value.forEach(r=>r.isSelected=!1),A=E(()=>{if(L.exports.cookies.filter=t.value,t.value==="All")return s.value;const r=`/${t.value}/`;return s.value.filter(p=>p.path.includes(r)&&(!b.value||i(p))).map(p=>(p.shorterPath=p.shortPath.split("/").pop(),p))});async function _(){P.value.current=o.value[0].path,await we()}async function m(){let{data:r}=await M.get("/load-game-folders");const p=R();r=r.filter(v=>!v.path.includes("Multiplayer")).map(v=>K(q({},v),{shortPath:v.path.split("/Saves/").pop(),isSelected:!1,date:N.mapValues(v.stat,h=>R(h).format("YYYY-MM-DD HH:mm:ss")),ago:N.mapValues(v.stat,h=>I(h,p))})),r=N.sortBy(r,"stat.mtimeMs").reverse(),s.value=r}return J(()=>{m(),te()}),(r,p)=>{const v=T("icon");return u(),d("div",ke,[e("div",Se,[e("h1",$e,[x(v,{name:"folder-open p-2"}),Ce]),n(b)?k("",!0):(u(),d("div",Pe,[n(o).length?(u(),d("button",{key:0,class:"btn bg-red-600 text-white",onClick:y},[x(v,{name:"ban"})])):k("",!0),e("button",{class:S(["path-current btn bg-green-600 text-white",{"opacity-50":!n(c)}]),disabled:!n(c),onClick:_}," Set Current ",10,Te),e("button",{class:"btn bg-orange-400 text-white",onClick:m},[x(v,{name:"sync"}),Ve])]))]),n(b)?k("",!0):(u(),d("div",Me,[Ae,(u(!0),d(F,null,G(n(a),h=>(u(),d("label",{key:h,class:"px-2 btn nowrap",title:h.fullname},[Z(e("input",{type:"radio",value:h.fullname,"onUpdate:modelValue":p[0]||(p[0]=B=>t.value=B)},null,8,Ee),[[X,t.value]]),C(" "+V(h.alias),1)],8,Be))),128))])),(u(!0),d(F,null,G(n(A),h=>(u(),d("div",{key:h.path},[e("label",Re,[n(b)?k("",!0):Z((u(),d("input",{key:0,type:"checkbox",class:"rel scale-150 -top-1 btn","onUpdate:modelValue":B=>h.isSelected=B},null,8,Ne)),[[W,h.isSelected]]),e("i",Le,[e("i",{class:S({"text-green-600":i(h)})},V(t.value==="All"?h.shortPath:h.shorterPath),3),i(h)?(u(),d("i",Ue,"C")):k("",!0)]),e("i",{class:"ml-auto opacity-50 font-mono",title:h.date.mtimeMs},V(h.ago.mtimeMs),9,De)])]))),128))])}}},Fe={class:"timed-snapshot mt-3 panel border-red-600border border-red-500"},Oe={class:"hbox items-center pb-4"},ze={class:"mr-4"},Ge=C("Timed Snapshot"),Ie={class:"hbox items-center ml-auto"},Ye=C(" Auto-Start "),He=e("i",{class:"b ml-3"},"Enabled",-1),je={class:"hbox border border-black rounded-md mb-2 p-1"},qe={class:"hbox items-center text-xl"},Ke=e("i",{class:"mr-2"},"Every:",-1),Qe=["value"],We={class:"hbox"},Je=e("i",null,"SAVE PREVIOUS",-1),Xe={class:"text-xs opacity-50 font-mono"},et=e("i",null,"SAVE RECENT",-1),tt={class:"text-xs opacity-50 font-mono"},st=e("i",null,"SAVE INSTANTLY!",-1),ot=e("i",{class:"text-xs opacity-50 mt-2 hbox items-center"},[e("b",{class:"fa fa-exclamation-triangle text-2xl mr-2"}),C(" Quit to MainMenu "),e("br"),C("or Exit Game first! ")],-1),nt=[st,ot],at={key:0,class:"border-4 border-double border-red-600 p-2"},lt={setup(l,{emit:a}){var Y;var t=null;const s=g([]),o=g(!1),c=E(()=>s.value.length==2),i=g(!1),y=g((Y=L.exports.cookies.isAutoStart)!=null?Y:!1),A="2s 10s 30s 5m 20m 60m".split(" "),_=g("5m"),m=g(""),r=E(()=>ee.value.isPZRunning);z(y,$=>(L.exports.cookies.isAutoStart=$,p($))),z(r,$=>p($));const p=$=>y.value&&(i.value=$);z(i,$=>{h()});const v={s:1,m:60};async function h(){if(!i.value){TweenMax.set("#progress",{width:"0%"}),t&&t.kill();return}const[$,f,U]=_.value.match(/([0-9]*)([a-z]*)/),O=f*v[U];o.value=!0,TweenMax.set("#progress",{width:"100%"});let{data:w}=await M.post("/buffer-snapshot");s.value=N.sortBy(w.pair,"dateZippedMS"),trace(s.value.map(D=>D.name).join(`
`)),o.value=!1,t=TweenMax.fromTo("#progress",O,{width:"0%"},{width:"100%",ease:D=>D,onComplete:h})}async function B($){m.value="";let{data:f}=await M.post("/buffer-write-current",{which:$});if(f.isError){m.value=f.isError,setTimeout(()=>m.value="",3e3);return}trace("onSaveBuffer",f),a("save-buffer")}return ce(()=>{trace("Killing the tween..."),t&&t.kill()}),($,f)=>{const U=T("icon"),O=T("ToggleButton");return u(),d("div",Fe,[e("div",Oe,[e("h1",ze,[x(U,{name:"camera p-2"}),Ge]),e("div",Ie,[e("i",{class:S(["b px-2 py-1 border rounded-md border-transparent transition-colors duration-200",{"border-green-500":n(r)}])},[Ye,x(U,{name:"circle",class:S([n(r)?"animate-pulse text-green-500":"text-gray-500 opacity-50"])},null,8,["class"])],2),x(O,{modelValue:y.value,"onUpdate:modelValue":f[0]||(f[0]=w=>y.value=w)},null,8,["modelValue"]),He,x(O,{modelValue:i.value,"onUpdate:modelValue":f[1]||(f[1]=w=>i.value=w)},null,8,["modelValue"])])]),e("div",je,[e("div",{id:"progress",class:S(["h-3 rounded-md",o.value?"bg-yellow-400":"bg-green-600"])},null,2)]),e("div",qe,[x(U,{name:"clock mr-1"}),Ke,(u(!0),d(F,null,G(n(A),w=>(u(),d("label",{key:w,class:S(["btn border-2 border-gray-400 px-3 py-1 rounded-xl text-white text-center mx-0 mr-1",_.value==w?"bg-green-500 border-green-200":"bg-blue-400 border-blue-200"])},[Z(e("input",{type:"radio",class:"hidden",value:w,"onUpdate:modelValue":f[2]||(f[2]=D=>_.value=D)},null,8,Qe),[[X,_.value]]),e("i",null,V(w),1)],2))),128))]),e("div",We,[e("button",{class:"btn w-full bg-red-900 text-white vbox all-center h-20",onClick:f[3]||(f[3]=w=>B("oldest")),title:"Create a ZIP based on the oldest snapshot."},[Je,e("i",Xe,V(n(c)?n(I)(s.value[0].dateZippedMS):"[--:--:--]"),1)]),e("button",{class:"btn w-full bg-yellow-700 text-white vbox all-center h-20",onClick:f[4]||(f[4]=w=>B("newest")),title:"Create a ZIP based on the newest snapshot."},[et,e("i",tt,V(n(c)?n(I)(s.value[1].dateZippedMS):"[--:--:--]"),1)]),e("button",{class:"btn w-full bg-green-900 text-white vbox all-center h-20",onClick:f[5]||(f[5]=w=>B("instantly")),title:"Create a new ZIP right now!"},nt)]),m.value?(u(),d("i",at,V(m.value),1)):k("",!0)])}}},rt={class:"file-backups p-2 panel"},it={class:"hbox items-center"},ct=C("Saved Snapshots"),ut={class:"break-words"},dt=["onClick"],pt={key:0,class:"ml-1"},mt=["onClick"],ht={key:0,class:"ml-1"},_t={setup(l,{expose:a}){const t=g(!1),s=g([]),o=E(()=>b.value?s.value.slice(s.value.length-3):s.value),c=_=>{const m=_.split("__").pop();return b.value?m.split(".")[0].replace("_"," "):m};async function i(){let{data:_}=await M.get("/backups");_.forEach(m=>m.cleanName=c(m.value)),s.value=N.sortBy(_,"cleanName")}async function y(_){if(t.value)return;t.value=!0;let{data:m}=await M.put("/backup-restore/"+_.key);trace(m),t.value=!1}async function A(_){if(t.value)return;t.value=!0;let{data:m}=await M.delete("/backup-delete/"+_.key);trace(m),await i(),t.value=!1}return a({updateBackupsList:i}),i(),(_,m)=>{const r=T("icon");return u(),d("div",rt,[e("div",it,[e("h1",null,[x(r,{name:"camera p-2"}),ct])]),e("div",{class:S(["backup-list vbox border border-gray-300 rounded-md my-1",[n(b)?"text-md grid grid-cols-3 p-1":"p-3",{"opacity-50":t.value}]])},[(u(!0),d(F,null,G(n(o),p=>(u(),d("div",{key:p.key,class:"vbox all-center"},[e("i",ut,V(p.cleanName),1),e("div",{class:S(["backup-buttons text-2xl",{"ml-auto":!n(b)}])},[e("button",{class:S(["btn bg-blue-600 text-white p-3",{"sml-btn":n(b)}]),onClick:v=>y(p)},[x(r,{name:"trash-arrow-up"}),n(b)?k("",!0):(u(),d("i",pt,"Restore"))],10,dt),e("button",{class:S(["btn bg-red-600 text-white p-3",{"sml-btn":n(b)}]),onClick:v=>A(p)},[x(r,{name:"trash"}),n(b)?k("",!0):(u(),d("i",ht,"Delete"))],10,mt)],2)]))),128))],2)])}}},vt={icon:fe,PanelConfigGameFolders:Ze,PanelTimedSnapshot:lt,PanelSavedSnapshots:_t,ToggleButton:ye};var ft={install(l,a){const t=[];N.forOwn(vt,(s,o)=>{l.component(o,s),t.push(o)}),trace("VUE - Registered: ",t.join(" "))}},bt="/assets/PzLogo.8f013a5d.png";function gt(l,a,t){const s={progress:0};TweenMax.to(s,a,{progress:1,onUpdate(){const{progress:o}=s;TweenMax.set(l,{rotation:Math.cos(o*20)*t*(1-o)})}})}const xt={class:"main-app vbox bg-gray-400 w-screen h-screen overflow-y-auto"},yt=e("div",{class:"abs inset-0 scanlines from-transparent to-black opacity-30 z-0"},null,-1),wt={class:"rel w-72 h-32 self-center"},kt={class:"vbox rel z-10 bg-white bg-opacity-80"},St={class:"vbox p-4 gap-2"},$t={class:"hbox nowrap"},Ct={key:0,class:"hbox items-center gap-2"},Pt=e("i",null,"PZ Root:",-1),Tt=C(" Save "),Vt={key:1,class:"ml-auto"},Mt={setup(l){const a=g(null);g(null);const t=g(null),s=g(null);async function o(){!t||!t.value||await t.value.updateBackupsList()}return J(()=>{gsap.to(".scanlines",.45,{"--scanline-y":"5px",repeat:-1,ease:c=>c})}),(c,i)=>{const y=T("icon"),A=T("PanelTimedSnapshot"),_=T("PanelConfigGameFolders"),m=T("PanelSavedSnapshots");return u(),d("div",xt,[yt,e("div",wt,[e("img",{class:"logo btn",alt:"PZ logo",src:bt,onClick:i[0]||(i[0]=r=>n(gt)(".logo",.5,10))})]),e("div",kt,[e("div",St,[e("div",$t,[n(b)?k("",!0):(u(),d("div",Ct,[Pt,Z(e("input",{class:"rounded-md p-2 shadow-inner shadow-gray-500 bg-opacity-70 bg-white w-full",type:"text","onUpdate:modelValue":i[1]||(i[1]=r=>n(P).pzRoot=r)},null,512),[[ue,n(P).pzRoot]]),e("button",{class:"btn bg-green-800 text-white w-48",onClick:i[2]||(i[2]=(...r)=>c.setConfig&&c.setConfig(...r))},[x(y,{name:"save mr-2"}),Tt])])),n(P).pzRoot?(u(),d("div",Vt,[e("button",{class:"btn w-36 bg-gray-700 text-white",onClick:i[3]||(i[3]=r=>b.value=!n(b))},[x(y,{name:"gear"}),C(" "+V(n(b)?"Advanced":"Compact"),1)])])):k("",!0)]),n(P).pzRoot?(u(),d(F,{key:0},[x(A,{ref_key:"panelTimedSnapshot",ref:s,config:n(P),onSaveBuffer:o},null,8,["config"]),x(_,{ref_key:"panelConfigGameFolders",ref:a,config:n(P)},null,8,["config"]),x(m,{ref_key:"panelSavedSnapshots",ref:t},null,512)],64)):k("",!0)])])])}}};R.extend(de);R.extend(pe);const se=me(Mt);se.use(ft);se.mount("#app");
