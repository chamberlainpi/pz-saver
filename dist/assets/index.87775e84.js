var se=Object.defineProperty,oe=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var H=(a,n,t)=>n in a?se(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,Y=(a,n)=>{for(var t in n||(n={}))ae.call(n,t)&&H(a,t,n[t]);if(j)for(var t of j(n))le.call(n,t)&&H(a,t,n[t]);return a},q=(a,n)=>oe(a,ne(n));import{r as b,a as M,c as T,d as A,o as l,b as c,n as B,e as $,w as O,v as W,u,f as e,i as re,g as S,h as x,j as E,k as X,F as U,l as Z,m as P,_ as N,p as J,t as C,q as F,s as ie,x as ce,y as K,z as ue,A as de,B as pe}from"./vendor.3cd06ae1.js";const he=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}};he();globalThis.trace=console.log.bind(console);const me=(a,n)=>{const t=b(a);async function o(){const{data:s}=await M.get(n);t.value=s[0]}return o(),t},_e=(a,n,t="modelValue")=>T({get:()=>a[t],set:o=>n(`update:${t}`,o)}),G=(a,n)=>A.duration((n||A()).diff(A(a))).format("D[d] HH:mm:ss [ago]").replace("0d ","");const ve={props:{name:String},setup(a){return(n,t)=>(l(),c("i",{class:B("fa fa-"+a.name)},null,2))}},be={class:"hbox items-center text-xs p-2 select-none cursor-pointer"},fe={key:0},ge={key:1,class:"abs right-2"},xe={props:{color:String,modelValue:Boolean},setup(a,{emit:n}){const o=_e(a,n);return(s,r)=>{const i=$("icon");return l(),c("label",be,[O(e("input",{type:"checkbox",class:"hidden","onUpdate:modelValue":r[0]||(r[0]=d=>re(o)?o.value=d:null)},null,512),[[W,u(o)]]),e("div",{class:B(["hbox items-center px-2 pt-1 w-14 h-7 rel rounded-full m-0 text-white leading-5",[u(o)?"bg-green-500":"bg-red-900"]])},[u(o)?S("",!0):(l(),c("i",fe,"OFF")),x(i,{name:"circle",class:B(["abs right-1 top-0 text-lg transition-all opacity-80",[u(o)?"-translate-x-7":""]])},null,8,["class"]),u(o)?(l(),c("i",ge,"ON")):S("",!0)],2)])}}},V=me({pzRoot:""},"/config"),Q=b({isBaselineSnapped:!1,isCurrentSnapped:!1});async function ee(){let{data:a}=await M.get("/status");Q.value=a,setTimeout(ee,3e3)}const ye={class:"game-folders panel"},we={class:"hbox all-center font-bold"},ke={class:"nowrap"},Se=P("Folders"),$e={class:"ml-auto"},Ce=["disabled"],Pe=P(" Refresh "),Ve={class:"hbox items-center w-full text-2xl px-2"},Me=e("i",{class:"font-bold"},"Filters:",-1),Be=["value"],Ae={class:"hbox all-center text-lg gap-2 px-2 py-1"},Re=["onUpdate:modelValue"],Te={class:"flex-shrink hbox all-center"},Ee={key:0,class:"small-tag bg-green-600"},Ue=["title"],Le={setup(a){const n="All, Builder, Survivor, Sandbox".split(", "),t=b(E.exports.cookies.filter||"All"),o=b([]),s=T(()=>o.value.filter(h=>h.isSelected)),r=T(()=>s.value.length===1?s.value[0]:null),i=h=>V.value.current===h.path,d=()=>o.value.forEach(h=>h.isSelected=!1),_=T(()=>{if(E.exports.cookies.filter=t.value,t.value==="All")return o.value;const h=`/${t.value}/`;return o.value.filter(f=>f.path.includes(h)).map(f=>(f.shorterPath=f.shortPath.split("/").pop(),f))});async function g(){V.value.current=s.value[0].path,await saveConfig()}async function y(){let{data:h}=await M.get("/load-game-folders");const f=A();h=h.filter(m=>!m.path.includes("Multiplayer")).map(m=>q(Y({},m),{shortPath:m.path.split("/Saves/").pop(),isSelected:!1,date:N.mapValues(m.stat,p=>A(p).format("YYYY-MM-DD HH:mm:ss")),ago:N.mapValues(m.stat,p=>G(p,f))})),h=N.sortBy(h,"stat.mtimeMs").reverse(),o.value=h}return X(()=>{y(),ee()}),(h,f)=>{const m=$("icon");return l(),c("div",ye,[e("div",we,[e("h1",ke,[x(m,{name:"folder-open p-2"}),Se]),e("div",$e,[u(s).length?(l(),c("button",{key:0,class:"btn bg-red-600 text-white",onClick:d},[x(m,{name:"ban"})])):S("",!0),e("button",{class:B(["path-current btn bg-green-600 text-white",{"opacity-50":!u(r)}]),disabled:!u(r),onClick:g}," Set Current ",10,Ce),e("button",{class:"btn bg-orange-400 text-white",onClick:y},[x(m,{name:"sync"}),Pe])])]),e("div",Ve,[Me,(l(!0),c(U,null,Z(u(n),p=>(l(),c("label",{key:p,class:"px-2 btn nowrap"},[O(e("input",{type:"radio",value:p,"onUpdate:modelValue":f[0]||(f[0]=R=>t.value=R)},null,8,Be),[[J,t.value]]),P(" "+C(p),1)]))),128))]),(l(!0),c(U,null,Z(u(_),p=>(l(),c("div",{key:p.path},[e("label",Ae,[O(e("input",{type:"checkbox",class:"rel scale-150 -top-1 btn","onUpdate:modelValue":R=>p.isSelected=R},null,8,Re),[[W,p.isSelected]]),e("i",Te,[e("i",{class:B({"text-green-600":i(p)})},C(t.value==="All"?p.shortPath:p.shorterPath),3),i(p)?(l(),c("i",Ee,"C")):S("",!0)]),e("i",{class:"ml-auto opacity-50 font-mono",title:p.date.mtimeMs},C(p.ago.mtimeMs),9,Ue)])]))),128))])}}},Ne={class:"periodic-snapshot mt-3 panel border-red-600border border-red-500"},Oe={class:"hbox items-center pb-4"},ze={class:"mr-4"},De=P("Periodic Snapshot"),Fe={class:"hbox items-center ml-auto"},Ze=e("i",{class:"b"},"Enabled",-1),Ge={class:"hbox border border-black rounded-md mb-2 p-1"},Ie={class:"hbox items-center text-xl"},je=e("i",{class:"mr-2"},"Every:",-1),He=["value"],Ye=e("i",null,"SAVE PREVIOUS",-1),qe=e("i",{class:"text-xs opacity-50"},"I've just been bitten / died / lost all my XP and I don't like it!",-1),Ke={class:"text-xs opacity-50"},We=e("i",null,"SAVE NOW!",-1),Xe=e("i",{class:"text-xs opacity-50"},"I'm satisfied with my progress and wish to save now.",-1),Je={class:"text-xs opacity-50"},Qe={key:0,class:"border-4 border-double border-red-600 p-2"},et={props:{isCompact:Boolean},setup(a,{emit:n}){var I;var t=null;const o=b([]),s=b(!1),r=T(()=>o.value.length==2),i=b(!1),d=b((I=E.exports.cookies.isAutoStart)!=null?I:!1),_="2s 10s 30s 5m 20m 60m".split(" "),g=b("5m"),y=b(""),h=T(()=>Q.value.isPZRunning);F(d,k=>(E.exports.cookies.isAutoStart=k,f(k))),F(h,k=>f(k));const f=k=>d.value&&(i.value=k);F(i,k=>{p()});const m={s:1,m:60};async function p(){if(!i.value){TweenMax.set("#progress",{width:"0%"}),t&&t.kill();return}const[k,v,z]=g.value.match(/([0-9]*)([a-z]*)/),D=v*m[z];s.value=!0,TweenMax.set("#progress",{width:"100%"});let{data:w}=await M.post("/buffer-snapshot");o.value=N.sortBy(w.pair,"dateZippedMS"),trace(o.value.map(L=>L.name).join(`
`)),s.value=!1,t=TweenMax.fromTo("#progress",D,{width:"0%"},{width:"100%",ease:L=>L,onComplete:p})}async function R(k){y.value="";let{data:v}=await M.post("/buffer-write-current",{which:k});if(v.isError){y.value=v.isError,setTimeout(()=>y.value="",3e3);return}trace("onSaveBufferNow",v),n("save-buffer")}return ie(()=>{trace("Killing the tween..."),t&&t.kill()}),(k,v)=>{const z=$("icon"),D=$("ToggleButton");return l(),c("div",Ne,[e("div",Oe,[e("h1",ze,[x(z,{name:"camera p-2"}),De]),e("div",Fe,[a.isCompact?S("",!0):(l(),c(U,{key:0},[e("i",{class:B(["b px-1 border rounded-md border-transparent transition-colors duration-200",{"border-green-700":u(h)&&d.value}])}," Auto-Start ",2),x(D,{modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=w=>d.value=w)},null,8,["modelValue"])],64)),Ze,x(D,{modelValue:i.value,"onUpdate:modelValue":v[1]||(v[1]=w=>i.value=w)},null,8,["modelValue"])])]),e("div",Ge,[e("div",{id:"progress",class:B(["h-3 rounded-md",s.value?"bg-yellow-400":"bg-green-600"])},null,2)]),e("div",Ie,[x(z,{name:"clock mr-1"}),je,(l(!0),c(U,null,Z(u(_),w=>(l(),c("label",{key:w,class:B(["btn border-2 border-gray-400 px-3 py-1 rounded-xl text-white text-center mx-0 mr-1",g.value==w?"bg-green-500 border-green-200":"bg-blue-400 border-blue-200"])},[O(e("input",{type:"radio",class:"hidden",value:w,"onUpdate:modelValue":v[2]||(v[2]=L=>g.value=L)},null,8,He),[[J,g.value]]),e("i",null,C(w),1)],2))),128))]),e("button",{class:"btn w-full h-48 bg-red-900 text-white vbox all-center",onClick:v[3]||(v[3]=w=>R("prev"))},[Ye,qe,e("i",Ke,C(u(r)?u(G)(o.value[0].dateZippedMS):"[not ready yet]"),1)]),e("button",{class:"btn w-full h-20 bg-green-900 text-white vbox all-center",onClick:v[4]||(v[4]=w=>R("now"))},[We,Xe,e("i",Je,C(u(r)?u(G)(o.value[1].dateZippedMS):"[not ready yet]"),1)]),y.value?(l(),c("i",Qe,C(y.value),1)):S("",!0)])}}},tt={class:"file-backups p-2 panel"},st={class:"hbox items-center"},ot=P("Saved Snapshots"),nt={class:"backup-list vbox border border-gray-300 rounded-md p-3 my-1"},at={class:"backup-buttons ml-auto"},lt=["onClick"],rt=P(" Restore "),it=["onClick"],ct=P(" Delete "),ut={setup(a,{expose:n}){const t=b([]);async function o(){let{data:i}=await M.get("/backups");t.value=i}async function s(i){let{data:d}=await M.put("/backup-restore/"+i.key);trace(d)}async function r(i){let{data:d}=await M.delete("/backup-delete/"+i.key);trace(d),await o()}return n({updateBackupsList:o}),o(),(i,d)=>{const _=$("icon");return l(),c("div",tt,[e("div",st,[e("h1",null,[x(_,{name:"camera p-2"}),ot])]),e("div",nt,[(l(!0),c(U,null,Z(t.value,g=>(l(),c("div",{key:g.key,class:"hbox all-center"},[e("i",null,C(g.value.split("__").pop()),1),e("div",at,[e("button",{class:"btn bg-blue-600 text-white",onClick:y=>s(g)},[x(_,{name:"trash-arrow-up"}),rt],8,lt),e("button",{class:"btn bg-red-600 text-white",onClick:y=>r(g)},[x(_,{name:"trash"}),ct],8,it)])]))),128))])])}}},dt={icon:ve,PanelConfigGameFolders:Le,PanelPeriodicSnapshot:et,PanelSavedSnapshots:ut,ToggleButton:xe};var pt={install(a,n){const t=[];N.forOwn(dt,(o,s)=>{a.component(s,o),t.push(s)}),trace("VUE - Registered: ",t.join(" "))}},ht="/assets/PzLogo.8f013a5d.png";function mt(a,n,t){const o={progress:0};TweenMax.to(o,n,{progress:1,onUpdate(){const{progress:s}=o;TweenMax.set(a,{rotation:Math.cos(s*20)*t*(1-s)})}})}const _t={class:"main-app vbox bg-gray-400 w-screen h-screen overflow-y-auto"},vt=e("div",{class:"abs inset-0 scanlines from-transparent to-black opacity-30 z-0"},null,-1),bt={class:"rel w-72 h-32 self-center"},ft={class:"vbox rel z-10 bg-white bg-opacity-80"},gt={class:"vbox p-4 gap-2"},xt={class:"hbox nowrap"},yt={key:0,class:"hbox items-center gap-2"},wt=e("i",null,"PZ Root:",-1),kt=P(" Save "),St={key:1,class:"ml-auto"},$t={setup(a){var i;const n=b(null);b(null);const t=b(null),o=b(null),s=b((i=E.exports.cookies.isCompact)!=null?i:!0);F(s,d=>E.exports.cookies.isCompact=d);async function r(){!t||!t.value||await t.value.updateBackupsList()}return X(()=>{gsap.to(".scanlines",.45,{"--scanline-y":"5px",repeat:-1,ease:d=>d})}),(d,_)=>{const g=$("icon"),y=$("PanelPeriodicSnapshot"),h=$("PanelConfigGameFolders"),f=$("PanelSavedSnapshots");return l(),c("div",_t,[vt,e("div",bt,[e("img",{class:"logo btn",alt:"PZ logo",src:ht,onClick:_[0]||(_[0]=m=>u(mt)(".logo",.5,10))})]),e("div",ft,[e("div",gt,[e("div",xt,[s.value?S("",!0):(l(),c("div",yt,[wt,O(e("input",{class:"rounded-md p-2 shadow-inner shadow-gray-500 bg-opacity-70 bg-white w-full",type:"text","onUpdate:modelValue":_[1]||(_[1]=m=>u(V).pzRoot=m)},null,512),[[ce,u(V).pzRoot]]),e("button",{class:"btn bg-green-800 text-white w-48",onClick:_[2]||(_[2]=(...m)=>d.setConfig&&d.setConfig(...m))},[x(g,{name:"save mr-2"}),kt])])),u(V).pzRoot?(l(),c("div",St,[e("button",{class:"btn w-36 bg-gray-700 text-white",onClick:_[3]||(_[3]=m=>s.value=!s.value)},[x(g,{name:"gear"}),P(" "+C(s.value?"Advanced":"Compact"),1)])])):S("",!0)]),u(V).pzRoot?(l(),c(U,{key:0},[x(y,{ref_key:"panelPeriodicSnapshot",ref:o,config:u(V),onSaveBuffer:r,isCompact:s.value},null,8,["config","isCompact"]),s.value?S("",!0):(l(),K(h,{key:0,ref_key:"panelConfigGameFolders",ref:n,config:u(V)},null,8,["config"])),s.value?S("",!0):(l(),K(f,{key:1,ref_key:"panelSavedSnapshots",ref:t},null,512))],64)):S("",!0)])])])}}};A.extend(ue);A.extend(de);const te=pe($t);te.use(pt);te.mount("#app");
