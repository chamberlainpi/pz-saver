var W=Object.defineProperty,X=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var D=(l,n,t)=>n in l?W(l,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[n]=t,F=(l,n)=>{for(var t in n||(n={}))Q.call(n,t)&&D(l,t,n[t]);if(z)for(var t of z(n))ee.call(n,t)&&D(l,t,n[t]);return l},G=(l,n)=>X(l,J(n));import{r as v,a as M,c as T,d as V,o as c,b as u,n as B,e as w,w as E,v as Z,u as d,f as e,i as te,g as y,h as g,j as I,k as H,F as L,l as U,m as S,_ as R,p as Y,t as k,q as se,s as oe,x as ne,y as j,z as ae,A as le,B as re}from"./vendor.3cd06ae1.js";const ie=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};ie();globalThis.trace=console.log.bind(console);const ce=(l,n)=>{const t=v(l);async function o(){const{data:s}=await M.get(n);t.value=s[0]}return o(),t},ue=(l,n,t="modelValue")=>T({get:()=>l[t],set:o=>n(`update:${t}`,o)}),O=(l,n)=>V.duration((n||V()).diff(V(l))).format("D[d] HH:mm:ss [ago]").replace("0d ","");const de={props:{name:String},setup(l){return(n,t)=>(c(),u("i",{class:B("fa fa-"+l.name)},null,2))}},pe={class:"hbox items-center text-xs p-2 select-none cursor-pointer"},he={key:0},_e={key:1,class:"abs right-2"},me={props:{color:String,modelValue:Boolean},setup(l,{emit:n}){const o=ue(l,n);return(s,i)=>{const r=w("icon");return c(),u("label",pe,[E(e("input",{type:"checkbox",class:"hidden","onUpdate:modelValue":i[0]||(i[0]=p=>te(o)?o.value=p:null)},null,512),[[Z,d(o)]]),e("div",{class:B(["hbox items-center px-2 pt-1 w-14 h-7 rel rounded-full m-0 text-white leading-5",[d(o)?"bg-green-500":"bg-red-900"]])},[d(o)?y("",!0):(c(),u("i",he,"OFF")),g(r,{name:"circle",class:B(["abs right-1 top-0 text-lg transition-all opacity-80",[d(o)?"-translate-x-7":""]])},null,8,["class"]),d(o)?(c(),u("i",_e,"ON")):y("",!0)],2)])}}},P=ce({pzRoot:""},"/config"),ve=v({isBaselineSnapped:!1,isCurrentSnapped:!1});async function q(){let{data:l}=await M.get("/status");ve.value=l,setTimeout(q,3e3)}const be={class:"game-folders panel"},fe={class:"hbox all-center font-bold"},ge={class:"nowrap"},xe=S("Folders"),ye={class:"ml-auto"},we=["disabled"],ke=S(" Refresh "),Se={class:"hbox items-center w-full text-2xl px-2"},$e=e("i",{class:"font-bold"},"Filters:",-1),Ce=["value"],Pe={class:"hbox all-center text-lg gap-2 px-2 py-1"},Me=["onUpdate:modelValue"],Ve={class:"flex-shrink hbox all-center"},Be={key:0,class:"small-tag bg-green-600"},Ae=["title"],Te={setup(l){const n="All, Builder, Survivor, Sandbox".split(", "),t=v(I.exports.cookies.filter||"All"),o=v([]),s=T(()=>o.value.filter(h=>h.isSelected)),i=T(()=>s.value.length===1?s.value[0]:null),r=h=>P.value.current===h.path,p=()=>o.value.forEach(h=>h.isSelected=!1),f=T(()=>{if(I.exports.cookies.filter=t.value,t.value==="All")return o.value;const h=`/${t.value}/`;return o.value.filter(_=>_.path.includes(h)).map(_=>(_.shorterPath=_.shortPath.split("/").pop(),_))});async function b(){P.value.current=s.value[0].path,await saveConfig()}async function $(){let{data:h}=await M.get("/load-game-folders");const _=V();h=h.filter(m=>!m.path.includes("Multiplayer")).map(m=>G(F({},m),{shortPath:m.path.split("/Saves/").pop(),isSelected:!1,date:R.mapValues(m.stat,a=>V(a).format("YYYY-MM-DD HH:mm:ss")),ago:R.mapValues(m.stat,a=>O(a,_))})),h=R.sortBy(h,"stat.mtimeMs").reverse(),o.value=h}return H(()=>{$(),q()}),(h,_)=>{const m=w("icon");return c(),u("div",be,[e("div",fe,[e("h1",ge,[g(m,{name:"folder-open p-2"}),xe]),e("div",ye,[d(s).length?(c(),u("button",{key:0,class:"btn bg-red-600 text-white",onClick:p},[g(m,{name:"ban"})])):y("",!0),e("button",{class:B(["path-current btn bg-green-600 text-white",{"opacity-50":!d(i)}]),disabled:!d(i),onClick:b}," Set Current ",10,we),e("button",{class:"btn bg-orange-400 text-white",onClick:$},[g(m,{name:"sync"}),ke])])]),e("div",Se,[$e,(c(!0),u(L,null,U(d(n),a=>(c(),u("label",{key:a,class:"px-2 btn nowrap"},[E(e("input",{type:"radio",value:a,"onUpdate:modelValue":_[0]||(_[0]=C=>t.value=C)},null,8,Ce),[[Y,t.value]]),S(" "+k(a),1)]))),128))]),(c(!0),u(L,null,U(d(f),a=>(c(),u("div",{key:a.path},[e("label",Pe,[E(e("input",{type:"checkbox",class:"rel scale-150 -top-1 btn","onUpdate:modelValue":C=>a.isSelected=C},null,8,Me),[[Z,a.isSelected]]),e("i",Ve,[e("i",{class:B({"text-green-600":r(a)})},k(t.value==="All"?a.shortPath:a.shorterPath),3),r(a)?(c(),u("i",Be,"C")):y("",!0)]),e("i",{class:"ml-auto opacity-50 font-mono",title:a.date.mtimeMs},k(a.ago.mtimeMs),9,Ae)])]))),128))])}}},Re={class:"periodic-snapshot mt-3 panel border-red-600border border-red-500"},Ee={class:"hbox items-center pb-4"},Le={class:"mr-4"},Ue=S("Periodic Snapshot"),Ne={class:"hbox items-center ml-auto"},Oe=e("i",{class:"b"},"Enabled",-1),ze={class:"hbox border border-black rounded-md mb-2 p-1"},De={class:"hbox items-center text-xl"},Fe=e("i",{class:"mr-2"},"Every:",-1),Ge=["value"],Ie=e("i",null,"SAVE PREVIOUS",-1),je=e("i",{class:"text-xs opacity-50"},"I've just been bitten / died / lost all my XP and I don't like it!",-1),Ze={class:"text-xs opacity-50"},He=e("i",null,"SAVE NOW!",-1),Ye=e("i",{class:"text-xs opacity-50"},"I'm satisfied with my progress and wish to save now.",-1),qe={class:"text-xs opacity-50"},Ke={key:0,class:"border-4 border-double border-red-600 p-2"},We={setup(l,{emit:n}){var t=null;const o=v([]),s=v(!1),i=T(()=>o.value.length==2),r=v(!1),p="2s 10s 30s 5m 20m 60m".split(" "),f=v("10s"),b=v("");se(r,m=>{h()});const $={s:1,m:60};async function h(){if(!r.value){TweenMax.set("#progress",{width:"0%"}),t&&t.kill();return}const[m,a,C]=f.value.match(/([0-9]*)([a-z]*)/),N=a*$[C];s.value=!0,TweenMax.set("#progress",{width:"100%"});let{data:x}=await M.post("/buffer-snapshot");o.value=R.sortBy(x.pair,"dateZippedMS"),trace(o.value.map(A=>A.name).join(`
`)),s.value=!1,t=TweenMax.fromTo("#progress",N,{width:"0%"},{width:"100%",ease:A=>A,onComplete:h})}async function _(m){b.value="";let{data:a}=await M.post("/buffer-write-current",{which:m});if(a.isError){b.value=a.isError,setTimeout(()=>b.value="",3e3);return}trace("onSaveBufferNow",a),n("save-buffer")}return oe(()=>{trace("Killing the tween..."),t&&t.kill()}),(m,a)=>{const C=w("icon"),N=w("ToggleButton");return c(),u("div",Re,[e("div",Ee,[e("h1",Le,[g(C,{name:"camera p-2"}),Ue]),e("div",Ne,[Oe,g(N,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=x=>r.value=x),label:"Auto-Save"},null,8,["modelValue"])])]),e("div",ze,[e("div",{id:"progress",class:B(["h-3 rounded-md",s.value?"bg-yellow-400":"bg-green-600"])},null,2)]),e("div",De,[g(C,{name:"clock mr-1"}),Fe,(c(!0),u(L,null,U(d(p),x=>(c(),u("label",{key:x,class:B(["btn border-2 border-gray-400 px-3 py-1 rounded-xl text-white text-center mx-0 mr-1",f.value==x?"bg-green-500 border-green-200":"bg-blue-400 border-blue-200"])},[E(e("input",{type:"radio",class:"hidden",value:x,"onUpdate:modelValue":a[1]||(a[1]=A=>f.value=A)},null,8,Ge),[[Y,f.value]]),e("i",null,k(x),1)],2))),128))]),e("button",{class:"btn w-full h-48 bg-red-900 text-white vbox all-center",onClick:a[2]||(a[2]=x=>_("prev"))},[Ie,je,e("i",Ze,k(d(i)?d(O)(o.value[0].dateZippedMS):"[not ready yet]"),1)]),e("button",{class:"btn w-full h-20 bg-green-900 text-white vbox all-center",onClick:a[3]||(a[3]=x=>_("now"))},[He,Ye,e("i",qe,k(d(i)?d(O)(o.value[1].dateZippedMS):"[not ready yet]"),1)]),b.value?(c(),u("i",Ke,k(b.value),1)):y("",!0)])}}},Xe={class:"file-backups p-2 panel"},Je={class:"hbox items-center"},Qe=S("Saved Snapshots"),et={class:"backup-list vbox border border-gray-300 rounded-md p-3 my-1"},tt={class:"backup-buttons ml-auto"},st=["onClick"],ot=S(" Restore "),nt=["onClick"],at=S(" Delete "),lt={setup(l,{expose:n}){const t=v([]);async function o(){let{data:r}=await M.get("/backups");t.value=r}async function s(r){let{data:p}=await M.put("/backup-restore/"+r.key);trace(p)}async function i(r){let{data:p}=await M.delete("/backup-delete/"+r.key);trace(p),await o()}return n({updateBackupsList:o}),o(),(r,p)=>{const f=w("icon");return c(),u("div",Xe,[e("div",Je,[e("h1",null,[g(f,{name:"camera p-2"}),Qe])]),e("div",et,[(c(!0),u(L,null,U(t.value,b=>(c(),u("div",{key:b.key,class:"hbox all-center"},[e("i",null,k(b.value.split("__").pop()),1),e("div",tt,[e("button",{class:"btn bg-blue-600 text-white",onClick:$=>s(b)},[g(f,{name:"trash-arrow-up"}),ot],8,st),e("button",{class:"btn bg-red-600 text-white",onClick:$=>i(b)},[g(f,{name:"trash"}),at],8,nt)])]))),128))])])}}},rt={icon:de,PanelConfigGameFolders:Te,PanelPeriodicSnapshot:We,PanelSavedSnapshots:lt,ToggleButton:me};var it={install(l,n){const t=[];R.forOwn(rt,(o,s)=>{l.component(s,o),t.push(s)}),trace("VUE - Registered: ",t.join(" "))}},ct="/assets/PzLogo.8f013a5d.png";function ut(l,n,t){const o={progress:0};TweenMax.to(o,n,{progress:1,onUpdate(){const{progress:s}=o;TweenMax.set(l,{rotation:Math.cos(s*20)*t*(1-s)})}})}const dt={class:"main-app vbox bg-gray-400 w-screen h-screen overflow-y-auto"},pt=e("div",{class:"abs inset-0 scanlines from-transparent to-black opacity-30 z-0"},null,-1),ht={class:"rel w-72 h-32 self-center"},_t={class:"vbox rel z-10 bg-white bg-opacity-80"},mt={class:"vbox p-4 gap-2"},vt={class:"hbox nowrap"},bt={key:0,class:"hbox items-center gap-2"},ft=e("i",null,"PZ Root:",-1),gt=S(" Save "),xt={key:1,class:"ml-auto"},yt={setup(l){const n=v(null);v(null);const t=v(null),o=v(null),s=v(!0);async function i(){!t||!t.value||await t.value.updateBackupsList()}return H(()=>{gsap.to(".scanlines",.45,{"--scanline-y":"5px",repeat:-1,ease:r=>r})}),(r,p)=>{const f=w("icon"),b=w("PanelPeriodicSnapshot"),$=w("PanelConfigGameFolders"),h=w("PanelSavedSnapshots");return c(),u("div",dt,[pt,e("div",ht,[e("img",{class:"logo btn",alt:"PZ logo",src:ct,onClick:p[0]||(p[0]=_=>d(ut)(".logo",.5,10))})]),e("div",_t,[e("div",mt,[e("div",vt,[s.value?y("",!0):(c(),u("div",bt,[ft,E(e("input",{class:"rounded-md p-2 shadow-inner shadow-gray-500 bg-opacity-70 bg-white w-full",type:"text","onUpdate:modelValue":p[1]||(p[1]=_=>d(P).pzRoot=_)},null,512),[[ne,d(P).pzRoot]]),e("button",{class:"btn bg-green-800 text-white w-48",onClick:p[2]||(p[2]=(..._)=>r.setConfig&&r.setConfig(..._))},[g(f,{name:"save mr-2"}),gt])])),d(P).pzRoot?(c(),u("div",xt,[e("button",{class:"btn w-36 bg-gray-700 text-white",onClick:p[3]||(p[3]=_=>s.value=!s.value)},[g(f,{name:"gear"}),S(" "+k(s.value?"Advanced":"Compact"),1)])])):y("",!0)]),d(P).pzRoot?(c(),u(L,{key:0},[g(b,{ref_key:"panelPeriodicSnapshot",ref:o,config:d(P),onSaveBuffer:i},null,8,["config"]),s.value?y("",!0):(c(),j($,{key:0,ref_key:"panelConfigGameFolders",ref:n,config:d(P)},null,8,["config"])),s.value?y("",!0):(c(),j(h,{key:1,ref_key:"panelSavedSnapshots",ref:t},null,512))],64)):y("",!0)])])])}}};V.extend(ae);V.extend(le);const K=re(yt);K.use(it);K.mount("#app");
